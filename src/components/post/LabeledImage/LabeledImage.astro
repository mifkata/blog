---
import { Image } from "astro:assets";

interface Props {
  src: ImageMetadata;
  alt: string;
  width?: number;
}

const { src, alt, width = 1280 } = Astro.props;
---

<figure class="labeled-image my-6 p-0">
  <Image
    {src}
    {alt}
    {width}
    class="clickable block mx-auto rounded-lg cursor-zoom-in"
    role="button"
    tabindex="0"
    aria-label={`${alt} - Click to enlarge`}
  />
  <figcaption
    class="text-center text-sm text-gray mt-2 italic [&_a]:text-accent"
  >
    <slot />
  </figcaption>
</figure>

<div class="modal hidden fixed inset-0 z-[1000]" aria-hidden="true">
  <div class="modal-backdrop absolute inset-0 bg-black/90"></div>
  <div
    class="modal-content relative p-[3%] w-full h-full flex items-center justify-center box-border"
  >
    <Image
      src={src}
      alt={alt}
      width={src.width}
      height={src.height}
      quality="max"
      class="max-w-full max-h-full object-contain rounded-lg"
    />
  </div>
</div>

<script>
  import { setupImageModals } from "./imageModal";
  setupImageModals();
  document.addEventListener("astro:page-load", setupImageModals);
</script>
