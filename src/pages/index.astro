---
import { getCollection } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Button from "../components/Button.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Header from "../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import heroBackground from "../assets/home-hero-bg.png";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const latestPost = posts[0];
const recentPosts = posts.slice(0, 3);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body>
    <div class="content-wrapper">
      <Header />
      <main>
        <!-- Hero Section -->
        <section
          class="relative px-14 py-12 bg-cover bg-center bg-no-repeat"
          style={`background-image: url(${heroBackground.src});`}
        >
          <div class="absolute inset-0 bg-white/30"></div>
          <div class="relative max-w-[960px] mx-auto">
            <div class="max-w-[720px]">
              <p class="text-lg mb-2">Hello, my name is</p>
              <h1 class="text-5xl md:text-6xl mb-4">Andriyan Ivanov.</h1>
              <h2 class="text-3xl md:text-4xl text-gray mb-6">
                I build Internet systems that scale.
              </h2>
              <p class="text-xl text-gray-dark mb-8 max-w-[560px]">
                Software Engineer passionate about efficient large-scale systems
                design and sharing knowledge. Welcome to my personal website
                where I write about technology, AI and software development.
              </p>
              <div class="flex flex-wrap gap-4">
                <Button href="/blog" variant="inverse" class="px-6 py-3">
                  Read my thoughts
                </Button>
                <Button href="/about" class="px-6 py-3">
                  Learn more about me
                </Button>
              </div>
            </div>
          </div>
        </section>

        <!-- Terminal Section -->
        <section class="max-w-[960px] mx-auto px-6 pb-12 mt-8">
          <div
            class="bg-gray-dark text-gray-light p-4 rounded-lg font-mono text-sm"
          >
            <span class="text-accent">$</span>
            <span class="text-white ml-2">cat current_focus.txt</span>
            <div class="mt-2 text-gray-light opacity-80">
              {">"} Currently exploring coding with AI, Elixir backends and designing
              distributed systems.
            </div>
          </div>
        </section>

        <!-- Current Focus Section -->
        <section class="max-w-[960px] mx-auto px-6 py-12">
          <div class="flex items-center gap-3 mb-6">
            <h3 class="text-lg m-0 text-gray uppercase tracking-wider">
              Current Focus
            </h3>
            <div class="flex-1 h-px bg-gray-light"></div>
          </div>
          <div class="bg-gray-light/50 p-6 rounded-lg border-l-4 border-accent">
            <p class="m-0 text-gray-dark">
              <span class="text-accent font-medium">Vibe Coding</span> — Exploring
              how AI agents can transform the way we build software, from idea to
              deployment.
            </p>
          </div>
        </section>

        <!-- Featured Showcase Section -->
        <section class="max-w-[960px] mx-auto px-6 py-12">
          <div class="flex items-center gap-3 mb-8">
            <h3 class="text-lg m-0 text-gray uppercase tracking-wider">
              Featured Showcase
            </h3>
            <div class="flex-1 h-px bg-gray-light"></div>
          </div>
          <div class="grid md:grid-cols-3 gap-6">
            <!-- Latest Post Card -->
            {
              latestPost && (
                <a
                  href={`/blog/${latestPost.id}/`}
                  class="group block p-6 bg-white border border-gray-light rounded-lg hover:border-accent hover:shadow-lg transition-all no-underline"
                >
                  <div class="text-sm text-gray mb-2 uppercase tracking-wider">
                    Latest Post
                  </div>
                  <h4 class="text-xl m-0 mb-2 text-black group-hover:text-accent transition-colors">
                    {latestPost.data.title}
                  </h4>
                  <p class="text-gray m-0 text-sm">
                    <FormattedDate date={latestPost.data.pubDate} />
                  </p>
                </a>
              )
            }

            <!-- Popular Post Card -->
            {
              posts[1] && (
                <a
                  href={`/blog/${posts[1].id}/`}
                  class="group block p-6 bg-white border border-gray-light rounded-lg hover:border-accent hover:shadow-lg transition-all no-underline"
                >
                  <div class="text-sm text-gray mb-2 uppercase tracking-wider">
                    Popular Post
                  </div>
                  <h4 class="text-xl m-0 mb-2 text-black group-hover:text-accent transition-colors">
                    {posts[1].data.title}
                  </h4>
                  <p class="text-gray m-0 text-sm">
                    <FormattedDate date={posts[1].data.pubDate} />
                  </p>
                </a>
              )
            }

            <!-- About Card -->
            <a
              href="/about"
              class="group block p-6 bg-white border border-gray-light rounded-lg hover:border-accent hover:shadow-lg transition-all no-underline"
            >
              <div class="text-sm text-gray mb-2 uppercase tracking-wider">
                About Me
              </div>
              <h4
                class="text-xl m-0 mb-2 text-black group-hover:text-accent transition-colors"
              >
                Learn More
              </h4>
              <p class="text-gray m-0 text-sm">
                Software engineer, writer, and lifelong learner
              </p>
            </a>
          </div>
        </section>

        <!-- Recent Posts Section -->
        <section class="max-w-[960px] mx-auto px-6 py-12">
          <div class="flex items-center justify-between mb-8">
            <div class="flex items-center gap-3">
              <h3 class="text-lg m-0 text-gray uppercase tracking-wider">
                Recent Posts
              </h3>
              <div class="flex-1 h-px bg-gray-light min-w-[100px]"></div>
            </div>
            <a
              href="/blog"
              class="text-accent hover:text-accent-dark no-underline text-sm"
            >
              View all posts →
            </a>
          </div>
          <ul class="list-none m-0 p-0 space-y-4">
            {
              recentPosts.map((post) => (
                <li class="border-b border-gray-light pb-4 last:border-0">
                  <a
                    href={`/blog/${post.id}/`}
                    class="group flex justify-between items-baseline gap-4 no-underline"
                  >
                    <span class="text-black group-hover:text-accent transition-colors">
                      {post.data.title}
                    </span>
                    <span class="text-gray text-sm shrink-0">
                      <FormattedDate date={post.data.pubDate} />
                    </span>
                  </a>
                </li>
              ))
            }
          </ul>
        </section>
      </main>
      <Footer />
    </div>
  </body>
</html>
