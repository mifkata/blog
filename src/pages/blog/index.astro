---
import { getCollection } from "astro:content";
import PageLayout from "@/layouts/PageLayout.astro";
import PageHeader from "@/components/pages/common/PageHeader/PageHeader.astro";
import FeaturedPost from "@/components/pages/blog/FeaturedPost/FeaturedPost.astro";
import PostsList from "@/components/pages/blog/PostsList/PostsList.astro";
import { SITE_TITLE } from "@/consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const featuredPost = posts[0];
const otherPosts = posts.slice(1);
---

<PageLayout
  title={`Blog | ${SITE_TITLE}`}
  description="All blog posts"
  size="wide"
>
  <PageHeader
    title="Blog"
    subtitle="Thoughts on software engineering, AI-assisted development, and building things for the web."
  />

  {featuredPost && <FeaturedPost post={featuredPost} />}

  <PostsList posts={otherPosts} title="All Posts" />
</PageLayout>
